# Phoenix Trading System - EXE 배포 빠른 시작 가이드

**목표:** Excel + EXE만으로 독립 실행 가능한 자동매매 시스템 배포

---

## 🚀 개발자용 - 빌드 절차 (5분)

### Step 1: 빌드 스크립트 실행

```bash
# 프로젝트 루트로 이동
cd D:\Project\SOLX

# 빌드 실행
python build_exe.py
```

**자동 수행 작업:**
- ✅ 이전 빌드 파일 정리
- ✅ PyInstaller 설치 확인
- ✅ EXE 파일 생성 (`dist/PhoenixTrading.exe`)
- ✅ 배포 패키지 생성 (`release/`)

**빌드 완료 시간:** 약 2~3분

---

### Step 2: 배포 패키지 확인

```bash
# release 폴더 확인
dir release
```

**기대 출력:**
```
release/
├── PhoenixTrading.exe              ← 실행 파일 (~30MB)
├── phoenix_grid_template_v3.xlsx   ← Excel 설정 파일
├── README_사용방법.txt
├── 배포_전_확인사항.txt
└── logs/
```

---

### Step 3: 배포 파일 압축

```powershell
# PowerShell에서 실행
Compress-Archive -Path release -DestinationPath PhoenixTrading_v4.1.zip
```

**또는** Windows 탐색기에서 `release` 폴더 우클릭 → "보내기" → "압축(ZIP) 폴더"

---

## 👥 사용자용 - 설치 절차 (3분)

### Step 1: 압축 해제

```
PhoenixTrading_v4.1.zip을 원하는 위치에 압축 해제
예: C:\PhoenixTrading\
```

---

### Step 2: Excel 설정

`phoenix_grid_template_v3.xlsx` 파일 열기

**필수 입력 항목:**

| 셀 위치 | 항목 | 입력 예시 |
|---------|------|-----------|
| **B12** | KIS APP KEY | `PSxxx...` |
| **B13** | KIS APP SECRET | `xxx...` |
| **B14** | KIS 계좌번호 | `12345678-01` |
| **B15** | 시스템 실행 | **FALSE** (처음엔 중지) |

**선택 입력 항목:**

| 셀 위치 | 항목 | 기본값 |
|---------|------|--------|
| B2 | 계좌번호 | (B14와 동일) |
| B3 | 종목코드 | `SOXL` (고정) |
| B4 | 투자금 (USD) | `10000` |
| B13 | 텔레그램 채팅 ID | (선택) |
| B14 | 텔레그램 봇 토큰 | (선택) |

**저장:** Ctrl+S

---

### Step 3: 프로그램 실행

```
PhoenixTrading.exe 더블클릭
```

**예상 화면 (B15=FALSE):**
```
╔══════════════════════════════════════════╗
║  Phoenix Trading System v4.1             ║
║  SOXL 자동매매 시스템                     ║
╚══════════════════════════════════════════╝

⚠️  경고: 실제 자금으로 거래합니다.

[OK] Excel 설정 로드 중...
[OK] 계좌번호: 12345678-01
[OK] 종목: SOXL
[OK] 투자금: $10,000.00
[OK] 시스템 실행: OFF

⚠️  시스템이 중지 상태입니다 (Excel B15=FALSE)

자동 거래를 시작하려면:
  1. Excel 파일 열기
  2. 시트 '01_매매전략_기준설정'
  3. B15 셀을 TRUE로 변경
  4. 저장 후 프로그램 재시작
```

---

### Step 4: 자동 거래 시작

**⚠️ 주의: 실거래가 시작됩니다!**

1. Excel 파일 열기
2. **B15 셀을 TRUE로 변경**
3. 저장 (Ctrl+S)
4. `PhoenixTrading.exe` 다시 실행

**예상 화면 (B15=TRUE):**
```
[OK] 시스템 실행: ON

KIS REST API 연결 중...
✅ KIS API 로그인 성공

SOXL 초기 시세 조회 중...
  - 현재가: $28.50
  - 시가: $27.80
  - 고가: $29.20
  - 저가: $27.50

계좌 잔고 조회 중...
  - 예수금: $10,500.00

✅ 시스템 초기화 완료!

메인 거래 루프 시작...
종료하려면 Ctrl+C를 누르세요.

[15:30:00] 💾 Excel 업데이트: 가격 $28.52, 포지션 0개
[15:30:05] 💾 Excel 업데이트: 가격 $28.51, 포지션 0개
[15:30:10] 📥 매수 신호: Tier 5, 10주 @ $28.45
[15:30:11] ✅ 매수 체결: Tier 5, 10주
...
```

---

### Step 5: 종료

**방법 1: 안전한 종료 (권장)**
```
콘솔 창에서 Ctrl+C 누르기
```

**방법 2: 거래 일시 중지**
```
Excel 파일 열기 → B15를 FALSE로 변경 → 저장 → 프로그램 재시작
```

**방법 3: 긴급 중지**
```
콘솔 창 닫기 (비권장, 데이터 손실 가능)
```

---

## 📊 Excel 제어 구조

### 시트 1: "01_매매전략_기준설정"

| 영역 | 셀 범위 | 역할 | 편집 가능 |
|------|---------|------|----------|
| **A (사용자 설정)** | B2:B15 | KIS API 키, 투자금 등 | ✅ 사용자 편집 |
| **B (프로그램 정보)** | D2:D10 | 현재가, 잔고, 보유량 등 | ❌ 읽기 전용 |
| **C (거래 정보)** | F2:F10 | 매수/매도 통계 | ❌ 읽기 전용 |
| **D (프로그램 영역)** | 2~242행 | 티어별 상태 (240개) | ❌ 읽기 전용 |

**핵심 제어 셀:**
- **B15 (시스템 실행)**: TRUE=시작, FALSE=중지
- **B9 (매수 제한)**: TRUE=매수 중단
- **B10 (매도 제한)**: TRUE=매도 중단

---

### 시트 2: "02_운용로그_히스토리"

| 열 | 항목 | 설명 |
|----|------|------|
| A | 타임스탬프 | 거래 시각 |
| B | 현재가 | SOXL 가격 |
| C | 보유량 | 총 주식 수 |
| D | 평가금 | 현재 평가액 |
| E | 수익률 | 실현 수익률 |
| F | 매수량 | 당일 매수 |
| G | 매도량 | 당일 매도 |

**업데이트 주기:** 1초 (설정 변경 가능)

---

## 🔒 보안 및 안전

### 중요 파일

| 파일 | 중요도 | 백업 필요 | 설명 |
|------|--------|----------|------|
| `phoenix_grid_template_v3.xlsx` | ⚠️ 매우 높음 | ✅ 필수 | API 키, 거래 상태 포함 |
| `logs/phoenix_*.log` | 📝 높음 | ✅ 권장 | 거래 기록 |
| `PhoenixTrading.exe` | 💿 중간 | ❌ 불필요 | 재빌드 가능 |

### API 키 보안

**⚠️ 주의:**
- Excel 파일에 KIS APP KEY/SECRET이 저장됨
- Excel 파일을 타인에게 전달하지 말 것
- Excel 파일을 클라우드 동기화 폴더에 저장 시 주의

**권장 사항:**
```
1. Excel 파일 암호 설정:
   Excel → 파일 → 정보 → 통합 문서 보호 → 암호로 암호화

2. 백업 시 암호화:
   7-Zip 등으로 암호 걸어서 압축

3. .env 파일 사용 (대안):
   API 키를 .env 파일에 저장하고 Excel에는 입력하지 않음
```

---

## 🐛 문제 해결 (빠른 참조)

| 증상 | 원인 | 해결 |
|------|------|------|
| "Excel 템플릿을 찾을 수 없음" | Excel 파일 누락 | Excel 파일을 EXE와 같은 폴더에 배치 |
| "KIS API 로그인 실패" | API 키 오류 | Excel B12/B13 재확인 |
| "VCRUNTIME140.dll 없음" | Visual C++ 누락 | VC++ 재배포 패키지 설치 |
| Windows Defender 경고 | 서명되지 않은 EXE | "추가 정보" → "실행" |
| 시스템이 시작 안 됨 | B15=FALSE | Excel B15를 TRUE로 변경 |

**상세 가이드:** `BUILD_AND_DEPLOY_GUIDE.md` 참조

---

## 📞 긴급 상황 대응

### 상황 1: 시스템 오작동
```
1. Ctrl+C로 즉시 종료
2. Excel B15를 FALSE로 변경
3. 로그 파일 확인: logs/phoenix_*.log
```

### 상황 2: Excel 파일 손상
```
1. Ctrl+C로 즉시 종료
2. 백업 파일 복원
3. 재시작
```

### 상황 3: 잘못된 주문 발생
```
1. Excel B9/B10를 TRUE로 변경 (매수/매도 중단)
2. 한국투자증권 HTS에서 수동 청산
3. 시스템 중지
```

---

## 📚 추가 문서

- **상세 빌드 가이드:** `BUILD_AND_DEPLOY_GUIDE.md`
- **개발 문서:** `TEST_IMPLEMENTATION_ALIGNMENT_REPORT.md`
- **24시간 테스트:** `24시간_테스트_빠른시작.md`
- **Excel 테스트:** `EXCEL_KIS_TESTING_GUIDE.md`

---

## ✅ 배포 체크리스트

### 개발자 체크리스트
- [ ] `python build_exe.py` 성공
- [ ] `release/PhoenixTrading.exe` 생성 확인
- [ ] Excel 템플릿 포함 확인
- [ ] 로컬 테스트 실행 (B15=FALSE)
- [ ] 로컬 테스트 실행 (B15=TRUE)
- [ ] ZIP 압축 완료

### 사용자 체크리스트
- [ ] ZIP 압축 해제
- [ ] Excel 파일에 KIS API 키 입력
- [ ] B15=FALSE 상태에서 테스트
- [ ] KIS API 연결 성공 확인
- [ ] 소액 ($1,000 이하)으로 시작
- [ ] 텔레그램 알림 활성화

---

**최종 업데이트:** 2026-01-20
**버전:** v4.1
