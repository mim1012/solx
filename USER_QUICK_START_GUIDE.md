# Phoenix Trading System - 사용자 빠른 시작 가이드

**버전**: v1.0
**대상**: 최종 사용자 (비개발자)
**소요 시간**: 약 10분

---

## 📖 시스템 소개

**Phoenix Trading System**은 SOXL 주식을 자동으로 매매하는 그리드 트레이딩 시스템입니다.

### 주요 특징
- ✅ **Excel 기반 설정**: 코드 수정 없이 Excel에서 모든 설정 관리
- ✅ **240단계 그리드**: 0.5% 간격으로 분할 매수, 3% 수익 시 매도
- ✅ **KIS REST API**: 한국투자증권 해외주식 거래 연동
- ✅ **실시간 모니터링**: Excel에서 거래 현황 실시간 확인
- ✅ **자동 히스토리**: 모든 거래 내역 자동 기록

### 작동 원리
```
SOXL 가격 하락 → 자동 매수 (분할 매수)
         ↓
SOXL 가격 상승 → 자동 매도 (3% 수익 실현)
```

---

## 🛠️ 필요한 것

### 1. 시스템 요구사항
- Windows 10/11 (64비트)
- Microsoft Excel 2016 이상
- 인터넷 연결

### 2. 한국투자증권 계좌
- 해외주식 거래 가능 계좌
- KIS Developers 가입 및 API 키 발급 필요

### 3. 초기 투자금
- 권장: $100 ~ $500 (소액 테스트)
- 최소: $50 (1~2개 티어만 거래)

---

## 🔑 KIS API 키 발급 방법

### Step 1: KIS Developers 가입
1. 웹브라우저에서 접속: https://apiportal.koreainvestment.com
2. 회원가입 (한국투자증권 계좌 보유자)
3. 로그인

### Step 2: 앱(APP) 등록
1. 메뉴: **My Application** 클릭
2. **앱 생성** 버튼 클릭
3. 정보 입력:
   - 앱 이름: `PhoenixTradingSOXL`
   - 설명: `SOXL 자동매매 시스템`
4. **저장** 클릭

### Step 3: API 키 발급
1. 생성된 앱 클릭
2. **App Key** 복사 → 메모장에 저장
3. **App Secret** 복사 → 메모장에 저장

**⚠️ 중요**:
- App Secret은 최초 1회만 표시됩니다. 반드시 저장하세요!
- 실계좌 거래는 **실전투자용 키**를 사용하세요 (모의투자 키와 다름)

---

## 📦 설치 절차 (3단계)

### Step 1: 파일 압축 해제

배포받은 `PhoenixTrading_v1.0.zip` 파일을 원하는 위치에 압축 해제하세요.

**권장 경로**:
```
C:\PhoenixTrading\
```

**압축 해제 후 파일 구조**:
```
C:\PhoenixTrading\
├── PhoenixTrading.exe               ← 실행 파일
├── phoenix_grid_template_v3.xlsx    ← Excel 설정 파일
├── USER_QUICK_START_GUIDE.md        ← 이 문서
├── PRE_TRADING_CHECKLIST.md         ← 실거래 전 체크리스트
└── logs\                            ← 로그 폴더 (자동 생성)
```

---

### Step 2: Excel 설정

`phoenix_grid_template_v3.xlsx` 파일을 Excel로 엽니다.

#### 시트 선택: "01_매매전략_기준설정"

#### 필수 입력 항목 (B12~B15)

| 셀 | 항목 | 입력 예시 | 설명 |
|---|---|---|---|
| **B12** | KIS APP KEY | `PSxxxxxxxxxxxxx` | KIS Developers에서 발급받은 App Key |
| **B13** | KIS APP SECRET | `xxxxxxxxxxxxxxxx` | KIS Developers에서 발급받은 App Secret |
| **B14** | KIS 계좌번호 | `12345678-01` | 한국투자증권 계좌번호 (하이픈 포함 가능) |
| **B15** | 시스템 가동 | **FALSE** | 처음엔 FALSE로 유지 (테스트 후 TRUE로 변경) |

#### 투자금 설정 (B4~B6)

| 셀 | 항목 | 입력 예시 | 설명 |
|---|---|---|---|
| **B4** | 총 투자금 (USD) | `10000` | 실제 투자할 총 금액 (소액 테스트 권장: $100~$500) |
| **B5** | 총 티어 개수 | `240` | 기본값 유지 권장 |
| **B6** | 티어당 투자금 | `=B4/B5` | **자동 계산됨** (수식 확인만 하세요) |

**예시 계산**:
- 총 투자금 $10,000 ÷ 240 티어 = 티어당 $41.67

#### 시스템 설정 (B16, B21)

| 셀 | 항목 | 기본값 | 설명 |
|---|---|---|---|
| **B16** | 시세 조회 주기 (초) | `40` | 기본값 권장 (40~60초) |
| **B21** | Excel 업데이트 주기 (초) | `1` | 기본값 권장 (1~5초) |

#### 저장
설정 완료 후 반드시 **저장** (Ctrl+S)하세요!

---

### Step 3: 테스트 실행 (B15=FALSE 상태)

#### 실행 방법
1. `PhoenixTrading.exe` 파일을 더블클릭
2. 검은 창(터미널)이 열립니다

#### 예상 출력 (정상)
```
=============================================================
Phoenix Trading System v4.1 초기화
=============================================================
Excel 파일: C:\PhoenixTrading\phoenix_grid_template_v3.xlsx
Excel 설정 로드 중...
  - 계좌번호: 12345678-01
  - 종목: SOXL
  - 투자금: $10,000.00
  - 시스템 실행: OFF

=============================================================
[STOP] 시스템이 중지 상태입니다 (Excel B15=FALSE)
=============================================================
[!] 이것은 에러가 아닙니다!
사용자가 Excel B15 셀을 FALSE로 설정하여 시스템이 중지된 상태입니다.

자동 거래를 시작하려면:
  1. Excel 파일 열기
  2. 시트 '01_매매전략_기준설정'
  3. B15 셀을 TRUE로 변경
  4. 저장 후 프로그램 재시작
=============================================================
```

**⚠️ 이것은 정상입니다!** B15=FALSE로 설정했기 때문에 거래가 시작되지 않습니다.

#### API 연결 테스트

만약 B15를 잠깐 TRUE로 변경했다면, 다음과 같은 로그를 확인할 수 있습니다:

```
GridEngine 초기화 중...
[AUTO] 티어당 투자금 자동 계산: $41.67 = $10,000 / 240 tiers
KIS REST API 연결 중...
[OK] KIS API 로그인 성공
SOXL 초기 시세 조회 중...
  - 현재가: $25.00
  - 시가: $24.50
  - 고가: $25.20
  - 저가: $24.30
계좌 잔고 조회 중...
  - 예수금: $10,000.00
```

**✅ 로그인 성공 확인 후 다시 B15=FALSE로 변경하세요!**

---

## 🚀 실거래 시작

### 사전 확인 (PRE_TRADING_CHECKLIST.md 참조)

실거래 시작 전 반드시 `PRE_TRADING_CHECKLIST.md` 문서의 모든 항목을 확인하세요!

**핵심 체크 항목**:
- [ ] B4 (총 투자금) 소액 설정 ($100~$500)
- [ ] B12~B14 KIS API 인증 정보 정확히 입력
- [ ] KIS API 로그인 테스트 성공
- [ ] SOXL 시세 조회 테스트 성공
- [ ] 계좌 잔고 조회 테스트 성공

### 거래 시작 절차

#### 1. Excel 파일 열기
```
phoenix_grid_template_v3.xlsx
```

#### 2. B15 셀을 TRUE로 변경
- 시트: "01_매매전략_기준설정"
- 셀 B15: `FALSE` → `TRUE`

#### 3. 저장 (Ctrl+S)

#### 4. 프로그램 실행
```
PhoenixTrading.exe 더블클릭
```

#### 5. 거래 시작 확인

예상 출력:
```
=============================================================
Phoenix Trading System v4.1 초기화
=============================================================
GridEngine 초기화 중...
[AUTO] 티어당 투자금 자동 계산: $41.67 = $10,000 / 240 tiers
KIS REST API 연결 중...
[OK] KIS API 로그인 성공
SOXL 초기 시세 조회 중...
  - 현재가: $25.00
계좌 잔고 조회 중...
  - 예수금: $10,000.00

🚀 자동매매 시작!
[메인 루프 실행 중 - 40초마다 시세 확인]
```

---

## 📊 실시간 모니터링

### Excel에서 확인 (실시간 업데이트)

#### 01_매매전략_기준설정 시트 (영역 E2~E8)

| 셀 | 필드명 | 설명 |
|---|---|---|
| E2 | 최근 업데이트 시간 | 마지막 업데이트 시각 |
| E3 | 현재 티어 | 현재 가격 기준 티어 (1~240) |
| E4 | 현재가 | SOXL 실시간 가격 |
| E5 | 잔고 | 계좌 예수금 |
| E6 | 총 보유 수량 | 보유 중인 SOXL 주식 수량 |
| E7 | 매수 상태 | 매수 가능/불가 상태 |
| E8 | 매도 상태 | 매도 가능/불가 상태 |

**업데이트 주기**: 1초마다 (B21 설정값)

#### 02_운용로그_히스토리 시트

모든 거래 내역이 자동으로 추가됩니다:
- 매수/매도 시각
- 체결 가격 및 수량
- 현재 잔고 및 수익률
- 투자금 및 평가액

**활용**: 거래 히스토리 분석, 수익률 추적

---

## 🛑 시스템 중단 방법

### 방법 1: Excel 설정 변경 (권장)

1. Excel 파일 열기: `phoenix_grid_template_v3.xlsx`
2. 시트: "01_매매전략_기준설정"
3. **B15 셀을 TRUE → FALSE로 변경**
4. 저장 (Ctrl+S)
5. 프로그램 재시작

### 방법 2: 프로그램 강제 종료

**터미널 창에서**:
```
Ctrl + C
```

**작업 관리자에서**:
1. `Ctrl+Shift+Esc` (작업 관리자 열기)
2. "PhoenixTrading.exe" 찾기
3. 우클릭 → "작업 끝내기"

---

## 🔧 문제 해결

### Q1: "Excel 파일을 찾을 수 없음" 오류

**원인**: EXE와 Excel 파일이 같은 폴더에 없습니다.

**해결**:
```
같은 폴더에 배치:
C:\PhoenixTrading\
├── PhoenixTrading.exe
└── phoenix_grid_template_v3.xlsx
```

---

### Q2: "KIS API 로그인 실패" 오류

**원인**: API 키가 잘못 입력되었거나 계좌번호가 틀렸습니다.

**해결**:
1. Excel B12~B14 재확인
2. App Key/Secret 복사 시 앞뒤 공백 제거
3. 계좌번호 형식 확인 (예: `12345678-01`)
4. 실계좌용 키인지 확인 (모의투자 키 아님)

---

### Q3: "시세 조회 실패" 오류

**원인**: 인터넷 연결 문제 또는 KIS API 서버 장애

**해결**:
1. 인터넷 연결 확인
2. KIS Developers 포털 접속 확인 (https://apiportal.koreainvestment.com)
3. 5분 후 재시도

---

### Q4: 매수/매도가 실행되지 않음

**원인 1**: B15=FALSE로 설정되어 있음
- **해결**: B15를 TRUE로 변경

**원인 2**: B9 또는 B10이 TRUE로 설정됨 (매매 제한)
- **해결**: B9, B10을 FALSE로 변경

**원인 3**: 현재 가격이 매수/매도 조건에 해당하지 않음
- **해결**: 정상 동작입니다. 조건 충족 시 자동 실행됩니다.

**원인 4**: 잔고 부족
- **해결**: B4 (총 투자금)를 줄이거나 계좌 입금

---

### Q5: Excel이 자동으로 업데이트되지 않음

**원인**: Excel 파일이 열려 있어 쓰기 잠금 상태입니다.

**해결**:
1. Excel 파일을 **읽기 전용으로 열기**
2. 또는 Excel을 닫고 프로그램만 실행
3. 필요시 B21 (Excel 업데이트 주기)를 5초로 증가

---

### Q6: 로그 파일은 어디에 있나요?

**위치**:
```
C:\PhoenixTrading\logs\phoenix_YYYYMMDD_HHMMSS.log
```

**예시**:
```
C:\PhoenixTrading\logs\phoenix_20260123_143022.log
```

**활용**: 거래 기록 상세 확인, 문제 진단

---

## 📞 지원 및 문의

### 한국투자증권 고객센터
- 전화: **1544-5000**
- 해외주식 거래 문의

### KIS API 기술 지원
- 웹사이트: https://apiportal.koreainvestment.com
- 메뉴: **개발자 포럼** 또는 **1:1 문의**

### 시스템 관련 문의
- 로그 파일 (`logs\` 폴더)을 첨부하여 문의
- Excel 설정 화면 캡처

---

## 📚 추가 자료

### 상세 문서
- `PRE_TRADING_CHECKLIST.md`: 실거래 전 체크리스트
- `EXE_DEPLOYMENT_QUICK_START.md`: 개발자용 빌드 가이드

### 거래 전략 설명
- **그리드 트레이딩**: 가격 하락 시 분할 매수, 상승 시 수익 실현
- **0.5% 간격 매수**: Tier 1 기준 0.5%씩 하락할 때마다 매수
- **3% 수익 매도**: 각 티어 매수가 대비 3% 상승 시 자동 매도

### 리스크 관리
- 소액으로 시작하세요 ($100~$500)
- 손실 가능 금액만 투자하세요
- 24시간 모니터링은 필요하지 않습니다 (자동 실행)
- 급격한 시장 변동 시 B15=FALSE로 즉시 중단 가능

---

## ✅ 빠른 체크리스트

실행 전 마지막 확인:

- [ ] KIS APP KEY/SECRET 입력 완료 (B12~B13)
- [ ] KIS 계좌번호 입력 완료 (B14)
- [ ] 총 투자금 소액 설정 완료 (B4: $100~$500)
- [ ] B15는 FALSE 상태 (테스트 완료 후 TRUE로 변경)
- [ ] Excel 파일과 EXE 파일 같은 폴더 위치 확인
- [ ] KIS API 로그인 테스트 성공 확인
- [ ] 로그 파일 정상 생성 확인 (`logs\` 폴더)

**모든 항목 확인 완료 → B15=TRUE로 변경 → 실거래 시작!**

---

**문서 버전**: v1.0
**최종 수정**: 2026-01-23
**작성자**: Claude Code
