Build Mode: release
Build Time: 2026-02-06 17:25:00
Python Version: 3.11.8
Platform: Windows
Version: v4.2 - Excel 별도 시트로 장시간 설정 지원

Executables:
- PhoenixTrading.exe (52MB) - 전체 자동매매 시스템
- USD잔고조회.exe (51MB) - USD 예수금 조회 도구

========================================
v4.2 주요 변경사항 - Excel 별도 시트 설정
========================================

[기능] 03_시스템설정 시트에서 장시간 설정
- 기존 데이터 보호: 01_매매전략_기준설정 시트는 그대로 유지
- 새 시트 추가: 03_시스템설정 시트에 모든 장시간 설정 분리
- Python 설치 없이 Excel 파일만 수정하여 설정 변경 가능

Excel 03_시스템설정 시트 구조:
  B8:  EDT 정규장 개장 (시) - 기본값 22
  B9:  EDT 정규장 개장 (분) - 기본값 30
  B10: EDT 정규장 마감 (시) - 기본값 5
  B11: EDT 정규장 마감 (분) - 기본값 0
  B14: EST 정규장 개장 (시) - 기본값 23
  B15: EST 정규장 개장 (분) - 기본값 30
  B16: EST 정규장 마감 (시) - 기본값 6
  B17: EST 정규장 마감 (분) - 기본값 0
  B20: 프리마켓 거래 허용 - 기본값 TRUE
  B21: 애프터마켓 거래 허용 - 기본값 TRUE

사용 방법:
1. phoenix_grid_template_v3.xlsx 파일 열기
2. "03_시스템설정" 시트로 이동
3. B열 값 수정
4. 파일 저장 (Ctrl+S)
5. PhoenixTrading.exe 재실행 (재빌드 불필요!)

예시: 정규장만 거래하고 싶은 경우
- B20 셀을 FALSE로 변경 (프리마켓 비활성화)
- B21 셀을 FALSE로 변경 (애프터마켓 비활성화)
- 파일 저장 후 .exe 재실행

========================================
⚠️ 중요: Excel 파일 업데이트 필요
========================================

기존 사용자는 다음 단계를 반드시 수행해야 합니다:

1. PhoenixTrading.exe 종료
2. 기존 phoenix_grid_template_v3.xlsx 백업
3. 새 phoenix_grid_template_v3.xlsx 파일 사용
   (03_시스템설정 시트 포함)
4. 01_매매전략_기준설정 시트의 기존 설정 확인
   (B12-B21: API 키, 계좌번호 등)
5. PhoenixTrading.exe 재실행

새 Excel 파일은 다음 3개 시트로 구성:
- 01_매매전략_기준설정 (기존 설정 유지)
- 02_운용로그_히스토리 (기존 로그 유지)
- 03_시스템설정 (신규, 장시간 설정)

========================================
KIS API 거래소 코드 이중 시스템 (v4.1 유지)
========================================

KIS API는 두 가지 다른 거래소 코드 형식을 사용:

1. 시세 조회 API (3글자):
   - NAS (나스닥)
   - AMS (아멕스)
   - NYS (뉴욕)

2. 거래/주문/잔고 API (4글자):
   - NASD (나스닥)
   - AMEX (아멕스)
   - NYSE (뉴욕)

Changes:
- config.py: US_MARKET_EXCHANGE = "AMEX" (거래 API용)
- kis_rest_adapter.py:
  * get_overseas_price(): 3글자 코드 (NAS, AMS, NYS)
  * get_overseas_daily_price_last(): 3글자 코드
  * _send_order_internal(): 4글자 코드 (AMEX)
  * get_cash_balance(): 4글자 코드 (AMEX)
- check_usd_balance.py: AMEX 거래소 코드 적용

SOXL 거래소 코드:
- 시세 조회: AMS (3글자)
- 거래/주문: AMEX (4글자)

Test Results (2026-02-06 17:00):
- 시세 조회: $53.25 (AMS로 성공)
- USD 잔고 조회: $339.77 (AMEX로 성공) ✅

========================================
전체 Excel 설정 요약
========================================

01_매매전략_기준설정 시트 (B12-B21):
  B12: KIS APP KEY
  B13: KIS APP SECRET
  B14: 계좌번호 (예: 12345678-01)
  B15: 시스템 실행 (TRUE=시작, FALSE=중지)
  B16: 시세 조회 주기 (초, 기본값 40.0)
  B18: 텔레그램 Chat ID
  B19: 텔레그램 Bot Token
  B20: 텔레그램 알림 (TRUE=활성화)
  B21: Excel 업데이트 주기 (초, 기본값 1.0)

03_시스템설정 시트 (B8-B21):
  장시간 설정 (위 참조)

========================================
파일 목록
========================================

release/
├── PhoenixTrading.exe (52MB)
│   - 전체 자동매매 시스템
│   - 03_시스템설정 시트 지원
│   - KIS API 이중 코드 시스템 적용
│
├── USD잔고조회.exe (51MB)
│   - USD 예수금 조회 전용 도구
│   - AMEX (4글자) 거래소 코드 사용
│
├── phoenix_grid_template_v3.xlsx
│   - 시스템 설정 파일 (3개 시트)
│   - .exe 파일과 같은 폴더에 위치 필수
│
├── BUILD_INFO_release.txt
│   - 이 파일
│
└── Excel_설정_가이드.txt
    - 비개발자용 사용 가이드

========================================
주의사항
========================================

1. Excel 파일 위치:
   - phoenix_grid_template_v3.xlsx는 .exe 파일과 같은 폴더에 있어야 함

2. 설정 변경 후:
   - Excel 파일 저장 후 .exe 재실행만 하면 됨
   - 재빌드 불필요!

3. 기본값 사용:
   - 03_시스템설정 시트가 없으면 config.py 기본값 사용
   - 일부만 설정 가능 (나머지는 기본값)

4. 거래소 코드:
   - SOXL은 시세=AMS(3글자), 거래=AMEX(4글자) 사용
   - 코드 내부에서 자동 변환됨
