========================================
Phoenix Trading System
Excel 설정 가이드 (비개발자용)
v4.2 - 03_시스템설정 시트
========================================

이 문서는 Python 설치 없이 Excel 파일만으로
시스템 설정을 변경하는 방법을 설명합니다.

========================================
1. 기본 사용 방법
========================================

1) phoenix_grid_template_v3.xlsx 파일 열기
2) "03_시스템설정" 시트로 이동 (하단 탭 클릭)
3) 필요한 셀 값 수정
4) 파일 저장 (Ctrl+S)
5) PhoenixTrading.exe 재실행

⚠️ 주의: .exe 파일 재빌드 불필요!
⚠️ 기존 데이터는 "01_매매전략_기준설정" 시트에 그대로 유지됩니다!

========================================
2. Excel 시트 구조
========================================

phoenix_grid_template_v3.xlsx는 3개 시트로 구성:

[01_매매전략_기준설정]
- 기존 설정 유지 (API 키, 계좌번호, 텔레그램 등)
- B12-B21 셀 사용

[02_운용로그_히스토리]
- 거래 로그 기록
- 자동으로 추가됨

[03_시스템설정] ⭐ 신규 시트
- 장시간 설정 전용
- B8-B21 셀 사용

========================================
3. 03_시스템설정 시트 사용법
========================================

시트 하단의 "03_시스템설정" 탭을 클릭하세요.

[서머타임 설정 (EDT, 3월~11월)]
B8:  EDT 정규장 개장 (시) - 기본값: 22
B9:  EDT 정규장 개장 (분) - 기본값: 30
B10: EDT 정규장 마감 (시) - 기본값: 5
B11: EDT 정규장 마감 (분) - 기본값: 0

[표준시 설정 (EST, 11월~3월)]
B14: EST 정규장 개장 (시) - 기본값: 23
B15: EST 정규장 개장 (분) - 기본값: 30
B16: EST 정규장 마감 (시) - 기본값: 6
B17: EST 정규장 마감 (분) - 기본값: 0

[거래 시간대]
B20: 프리마켓 거래 허용 (TRUE/FALSE)
B21: 애프터마켓 거래 허용 (TRUE/FALSE)

========================================
4. 자주 사용하는 설정 예시
========================================

[예시 1] 정규장만 거래하기
→ 03_시스템설정 시트 열기
→ B20 셀: FALSE (프리마켓 비활성화)
→ B21 셀: FALSE (애프터마켓 비활성화)
→ 파일 저장 후 재실행

[예시 2] 서머타임 장시간 30분 앞당기기
→ 03_시스템설정 시트 열기
→ B8 셀: 22 → 21로 변경 (개장 1시간 앞당김)
→ B24 셀: 5 → 4로 변경 (마감 1시간 앞당김)

또는

→ B8 셀: 22 그대로
→ B9 셀: 30 → 0으로 변경 (개장 30분 앞당김)
→ B10 셀: 5 → 4로 변경
→ B11 셀: 0 → 30으로 변경 (마감 30분 앞당김)

[예시 3] 시세 조회 주기 변경 (부하 줄이기)
→ 01_매매전략_기준설정 시트 열기
→ B16 셀: 40 → 60으로 변경 (40초 → 60초)

[예시 4] 텔레그램 알림 활성화
→ 01_매매전략_기준설정 시트 열기
→ B18 셀: 텔레그램 Chat ID 입력
→ B19 셀: 텔레그램 Bot Token 입력
→ B20 셀: TRUE

========================================
5. 시간 설정 이해하기
========================================

모든 시간은 "한국 시간" 기준입니다.

[서머타임 (EDT, 3월~11월)]
- 미국 동부시간 + 13시간 = 한국 시간
- 미국 09:30 = 한국 22:30
- 미국 16:00 = 한국 05:00 (다음날)

[표준시 (EST, 11월~3월)]
- 미국 동부시간 + 14시간 = 한국 시간
- 미국 09:30 = 한국 23:30
- 미국 16:00 = 한국 06:00 (다음날)

시스템이 자동으로 서머타임/표준시를 판단하여
해당 시간 설정을 사용합니다.

========================================
6. 기본값 사용하기
========================================

특정 셀을 비워두면 시스템 기본값을 사용합니다.

예시:
- 03_시스템설정 시트가 없음 → 시스템 기본값 사용
- B8-B21을 모두 비움 → 시스템 기본 장시간 사용
- B8, B9만 설정 → EDT 개장시간만 변경, 나머지는 기본값

========================================
7. 문제 해결
========================================

[문제] Excel 파일을 수정했는데 적용 안됨
[해결]
1. Excel 파일 저장했는지 확인 (Ctrl+S)
2. 올바른 시트를 수정했는지 확인
   - 장시간 설정: 03_시스템설정 시트
   - API/계좌: 01_매매전략_기준설정 시트
3. PhoenixTrading.exe 재실행
4. 실행 중이면 종료 후 다시 실행

[문제] 03_시스템설정 시트가 없음
[해결]
새 phoenix_grid_template_v3.xlsx 파일 사용
(기존 파일 백업 후 교체)

[문제] Excel 파일이 없다고 나옴
[해결]
phoenix_grid_template_v3.xlsx 파일이
PhoenixTrading.exe와 같은 폴더에 있는지 확인

[문제] 셀에 뭘 써야 할지 모르겠음
[해결]
1. 셀을 비워두면 기본값 사용됨
2. BUILD_INFO_release.txt 파일 참조
3. 기본 템플릿의 값 참조

========================================
8. 안전하게 테스트하기
========================================

1. 원본 Excel 파일 백업
   - phoenix_grid_template_v3.xlsx를 복사하여
     phoenix_grid_template_v3_backup.xlsx로 저장

2. 설정 변경 (03_시스템설정 시트)

3. PhoenixTrading.exe 실행하여 테스트

4. 문제 발생 시
   - 백업 파일을 원래 이름으로 복원
   - 다시 실행

========================================
9. 기존 사용자 업그레이드 방법
========================================

v4.1에서 v4.2로 업그레이드:

1. PhoenixTrading.exe 종료

2. 기존 phoenix_grid_template_v3.xlsx 백업
   (다른 이름으로 저장)

3. 새 phoenix_grid_template_v3.xlsx 사용
   (03_시스템설정 시트 포함)

4. 01_매매전략_기준설정 시트에서 기존 설정 확인:
   - B12: KIS APP KEY
   - B13: KIS APP SECRET
   - B14: 계좌번호
   등등

5. 03_시스템설정 시트에서 장시간 설정 확인
   (필요시 수정)

6. 파일 저장 후 PhoenixTrading.exe 재실행

========================================
10. 추가 도움말
========================================

더 자세한 정보는 다음 파일을 참조하세요:
- BUILD_INFO_release.txt: 전체 변경 사항
- phoenix_grid_template_v3.xlsx: 실제 설정 파일

질문이나 문제가 있으면 개발자에게 문의하세요.
